// Test vectors from https://github.com/bitcoin/bips/blob/master/bip-0143.mediawiki#p2sh-p2wpkh

// Native P2WPKH
assert::eq(
  tx::sighash(
    0x0100000002fff7f7881a8099afa6940d42d1e7f6362bec38171ea3edf433541db4e4ad969f0000000000eeffffffef51e1b804cc89d182d279655c3aa89e815b1b309fe287d9b2b55d57b90ec68a0100000000ffffffff02202cb206000000001976a9148280b37df378db99f66f85c95a783a76ac7a6d5988ac9093510d000000001976a9143bde42dbee7e4dbe6a21b2d50ce2f0167faa815988ac11000000,
    1,
    [``:0, wpkh(025476c2e83188368da1ff3e292e7acafcdb3566bb0ad253f62fc70f07aeee6357):6 BTC],
    SIGHASH_ALL
  ),
  0xc37af31116d1b27caf68aae9e3ac82f1477929014d5b917657d0eb49478cb670
);

// P2SH-P2WPKH
assert::eq(
  tx::sighash(
    0x0100000001db6b1b20aa0fd7b23880be2ecbd4a98130974cf4748fb66092ac4d3ceb1a54770100000000feffffff02b8b4eb0b000000001976a914a457b684d7f0d539a46a45bbc043f35b59d0d96388ac0008af2f000000001976a914fd270b1ee6abcaea97fea7ad0402e8bd8ad6d77c88ac92040000,
    0,
    [sh(wpkh(03ad1d8e89212f0b92c74d23bb710c00662ad1470198ac48c43f7d6f93a2a26873)):10 BTC],
    SIGHASH_ALL
  ),
  0x64f3b0f4dd2bb3aa1ce8566d220cc74dda9df97d8490cc81d89d735c92e59fb6
);
